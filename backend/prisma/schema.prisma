// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

enum UserRole {
  JOB_SEEKER
  RECRUITER
  ADMIN
}

enum JobType {
  FULL_TIME
  PART_TIME
  CONTRACT
  INTERNSHIP
  FREELANCE
}

enum ApplicationStatus {
  PENDING
  REVIEWED
  SHORTLISTED
  INTERVIEWD
  ACCEPTED
  REJECTED
}

enum ExperienceLevel {
  ENTRY_LEVEL
  MID_LEVEL
  SENIOR_LEVEL
  EXECUTIVE
}

model User {
  id String @id @default(uuid())
  email String @unique
  password String
  role UserRole @default(JOB_SEEKER)
  isVerified Boolean @default(false)
  verificationToken String?
  resetToken String?
  resetTokenExpiry DateTime?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  profile Profile?
  company Company?
  applications Application[]
  savedJobs SavedJob[]

  @@index([email])
}

model Profile{
  id String @id @default(uuid())
  userId String @unique
  firstName String
  lastName String
  phone String?
  address String?
  city String?
  state String?
  country String?
  zipCode String?
  bio String? @db.Text
  resumeUrl String?
  profilePictureUrl String?
  skills String[]
  experience Json[]
  education Json[]
  linkedInUrl String?
  githubUrl String?
  portfolioUrl String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Company {
  id String @id @default(uuid())
  userId String @unique
  name String
  description String? @db.Text
  industry String?
  website String?
  logo String?
  size String?
  location String?
  isVerified Boolean @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  jobs Job[]
}

model Job{
  id String @id @default(uuid())
  companyId String
  title String
  description String @db.Text
  requirements String[] 
  responsibilities String[]
  skills String[]
  jobType JobType
  experienceLevel ExperienceLevel
  location String
  isRemote Boolean @default(false)
  salaryMin Int?
  salaryMax Int?
  currency String? @default("USD")
  benefits String[]
  applicationDeadline DateTime?
  positionsAvailable Int @default(1)
  isActive Boolean @default(true)
  views Int @default(0)
  postedAt DateTime @default(now())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  company Company @relation(fields: [companyId], references: [id], onDelete: Cascade)
  applications Application[]
  savedBy SavedJob[]

  @@index([title])
  @@index([companyId])
  @@index([location])
  @@index([jobType])
}

model Application {
  id String @id @default(uuid())
  jobId String
  userId String
  coverLetter String? @db.Text
  resumeUrl String?
  status ApplicationStatus @default(PENDING)
  appliedAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  notes String? @db.Text

  job Job @relation(fields: [jobId], references: [id], onDelete: Cascade)
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([jobId, userId])
  @@index([jobId])
  @@index([userId])
  @@index([status])
}

model SavedJob {
  id String @id @default(uuid())
  userId String
  jobId String
  savedAt DateTime @default(now())

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  job Job @relation(fields: [jobId], references: [id], onDelete: Cascade)

  @@unique([jobId, userId])
  @@index([userId])
}

model Category {
  id String @id @default(uuid())
  name String @unique
  description String?
  icon String?
  createdAt DateTime @default(now())
}